(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,i){e.exports=i(24)},21:function(e,t,i){},24:function(e,t,i){"use strict";i.r(t);var n=i(7),a=i.n(n),o=i(11),s=i.n(o),r=(i(21),i(1)),c=i(5),h=i(3),l=i(2),d=i(4),p=i(6),u=i(0),m=i(12),y=i(8),v=i(9),w=function(){function e(t,i){Object(r.a)(this,e),this.scene=t,this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.buffer=5,this.velocity=new u.Lb(0,0,0),this.position=new u.Lb(0,0,0),this.direction=new u.Lb(0,0,0),this.orientation=new u.Lb(-1,0,0),this.actions={moveForward:!1,moveBackward:!1,moveLeft:!1,moveRight:!1,canJump:!1},this.dampening=40,this.speed=1e4,this.parent=new u.db,this.parent.name="spider",this.parent.add(i.spider.val.scene),i.spider.val.scene.rotateOnAxis(new u.Lb(0,1,0),1.57075),t.add(this.parent)}return Object(c.a)(e,[{key:"onKeyDown",value:function(e){switch(e.code){case"ArrowUp":case"KeyW":this.actions.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.actions.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.actions.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.actions.moveRight=!0;break;case"Space":!0===this.actions.canJump&&(this.velocity.y+=500);break;default:console.log("Unknown key input: "+e.code)}}},{key:"onKeyUp",value:function(e){switch(e.code){case"ArrowUp":case"KeyW":this.actions.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.actions.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.actions.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.actions.moveRight=!1;break;default:console.log("Unknown key input: "+e.code)}}},{key:"update",value:function(e,t,i){this.velocity.x-=this.velocity.x*this.dampening*e,this.velocity.z-=this.velocity.z*this.dampening*e,this.velocity.y-=.01*this.velocity.y*this.dampening*e,this.velocity.y-=9.8*100*e,this.direction.z=Number(this.actions.moveForward)-Number(this.actions.moveBackward),this.direction.x=Number(this.actions.moveRight)-Number(this.actions.moveLeft),this.direction.normalize(),0==this.direction.x&&0==this.direction.z||(this.direction.applyQuaternion(i.clone().invert()),this.direction.y=0,this.direction.normalize(),this.velocity.z-=this.direction.z*this.speed*e,this.velocity.x-=this.direction.x*this.speed*e),this.position.x+=-this.velocity.x*e,this.position.z+=this.velocity.z*e;var n=[],a=this.scene.children.map(function(e){if("spider"!=e.name)return"Mesh"==e.type?e:e.children.length>0&&"Mesh"==e.children[0].type?e.children[0]:void 0});if(a=a.filter(function(e){return void 0!=e}),this.buffer-this.velocity.y*e>0){var o=this.position.clone();o.y=o.y+this.buffer,n=new u.wb(o,new u.Lb(0,-1,0),0,this.buffer-this.velocity.y*e).intersectObjects(a)}n.length>0?(this.position.y=n[0].point.y,this.velocity.y=0):this.position.y+=this.velocity.y*e,this.position.y<0&&(this.velocity.y=0,this.position.y=0,this.actions.canJump=!0);var s=this.velocity.clone();s.x=-s.x,0!=s.length()&&(s.y=s.y/2,this.orientation.lerp(s.normalize(),.131),this.orientation.normalize());var r=new u.mb;r.setFromUnitVectors(this.orientation,new u.Lb(0,-1,0)),r.multiply((new u.mb).setFromUnitVectors(new u.Lb(0,-1,0),new u.Lb(-1,0,0))),(new u.q).setFromQuaternion(r),this.parent.lookAt(this.parent.position.clone().sub(this.orientation)),this.parent.position.copy(this.position.clone())}}]),e}(),b=i(13),f=function(){function e(t,i){Object(r.a)(this,e),this.scene=t,this.resDict=i,this.mesh=this.generateMesh(),this.mesh.position.y=20,this.scene.add(this.mesh)}return Object(c.a)(e,[{key:"generateMesh",value:function(){var e=this.generateHeight(256,256),t=new u.hb(2e3,2e3,255,255);t.rotateX(-Math.PI/2);for(var i=t.vertices,n=0,a=i.length;n<a;n++)i[n].y=.6*e[n];var o=new u.h(this.generateTexture(e,256,256));return o.wrapS=u.i,o.wrapT=u.i,new u.T(t,new u.U({map:o}))}},{key:"generateHeight",value:function(e,t){var i=Math.PI/4;window.Math.random=function(){var e=1e4*Math.sin(i++);return e-Math.floor(e)};for(var n=e*t,a=new Int16Array(n),o=new b.a,s=100*Math.random(),r=1,c=0;c<4;c++){for(var h=0;h<n;h++){var l=h%e,d=~~(h/e);a[h]+=Math.abs(o.noise(l/r,d/r,s)*r*1.75)}r*=5}for(var p=[320,1200],u=0;u<n;u++){var m=u%e-e/2,y=~~(u/e)-e/2,v=m*m+y*y;v<p[0]?a[u]=-1e3:v<p[1]&&(a[u]=(v-p[0])/(p[1]-p[0])*a[u])}return a}},{key:"generateTexture",value:function(e,t,i){var n,a,o,s,r=new u.Lb(0,0,0),c=new u.Lb(1,1,1);c.normalize();var h=document.createElement("canvas");h.width=t,h.height=i,(n=h.getContext("2d")).fillStyle="#000",n.fillRect(0,0,t,i);for(var l=0,d=0,p=(o=(a=n.getImageData(0,0,h.width,h.height)).data).length;l<p;l+=4,d++)r.x=e[d-2]-e[d+2],r.y=2,r.z=e[d-2*t]-e[d+2*t],r.normalize(),s=r.dot(c),s/=1,o[l]=(96+128*s)*(.5+.007*e[d])/2,o[l+1]=(32+96*s)*(.5+.007*e[d])/2,o[l+2]=96*s*(.5+.007*e[d])/2;n.putImageData(a,0,0);var m=document.createElement("canvas");m.width=4*t,m.height=4*i,(n=m.getContext("2d")).scale(4,4),n.drawImage(h,0,0);for(var y=0,v=(o=(a=n.getImageData(0,0,m.width,m.height)).data).length;y<v;y+=4){var w=~~(5*Math.random());o[y]+=w,o[y+1]+=w,o[y+2]+=w}return n.putImageData(a,0,0),m}},{key:"update",value:function(e){}}]),e}(),g=i(15),k=function(){function e(t){var i=this;Object(r.a)(this,e),this.promises=[];for(var n=function(){var e=o[a],t=(s=Object(g.a)(e,2))[0],n=s[1],r=void 0;switch(n.type){case"GLTF":r=i.loadGLTF(n.url);break;case"RGBE":r=i.loadRGBE(n.url);break;case"Cube":r=i.loadCube(n.path,n.urls);break;default:console.log("ERROR: unknown import type - "+n.type)}i.promises.push(r.then(function(e){n.val=e,n.confirm="Confirmed - "+t}))},a=0,o=Object.entries(t);a<o.length;a++){var s;n()}return Promise.all(this.promises)}return Object(c.a)(e,[{key:"loadGLTF",value:function(e){return new Promise(function(t){(new y.a).load(e,t)})}},{key:"loadRGBE",value:function(e){return new Promise(function(t){(new v.a).load(e,t)})}},{key:"loadCube",value:function(e,t){var i=new u.l;return i.setPath(e),new Promise(function(e){i.load(t,e)})}}]),e}(),j=(i(23),i(14)),x=function(e){function t(e){var i;return Object(r.a)(this,t),(i=Object(h.a)(this,Object(l.a)(t).call(this,e))).state={},i.resDict={spider:{type:"GLTF",url:"/Assets/spider.gltf"},crater:{type:"GLTF",url:"/Assets/crater.glb"},texCube:{type:"Cube",path:"https://threejs.org/examples/textures/cube/Bridge2/",urls:["posx.jpg","negx.jpg","posy.jpg","negy.jpg","posz.jpg","negz.jpg"]},flower:{type:"GLTF",url:"https://threejs.org/examples/models/gltf/Flower/Flower.glb"}},i.loadPromise=new k(i.resDict).then(function(e){console.log("INFO: All assets loaded!")}),i.start=i.start.bind(Object(p.a)(Object(p.a)(i))),i.stop=i.stop.bind(Object(p.a)(Object(p.a)(i))),i.animate=i.animate.bind(Object(p.a)(Object(p.a)(i))),i.renderScene=i.renderScene.bind(Object(p.a)(Object(p.a)(i))),i.setupScene=i.setupScene.bind(Object(p.a)(Object(p.a)(i))),i.destroyContext=i.destroyContext.bind(Object(p.a)(Object(p.a)(i))),i.handleWindowResize=i.handleWindowResize.bind(Object(p.a)(Object(p.a)(i))),i}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){window.addEventListener("resize",this.handleWindowResize)}},{key:"componentDidMount",value:function(){var e=this;this.loadPromise.then(function(){e.setupScene()})}},{key:"setupScene",value:function(){this.width=this.container.clientWidth,this.height=this.container.clientHeight;var e=new u.Nb({antialias:!0});e.setPixelRatio(window.devicePixelRatio),e.shadowMap.enabled=!0,e.gammaOutput=!0,e.gammaFactor=2.2,e.shadowMap.type=u.fb;var t=new u.yb;t.fog=new u.u(15716789,25e-5);var i=new u.gb(60,this.width/this.height,.25,12e3);t.add(i),this.renderer=e,this.scene=t,this.camera=i,this.player=new w(t,this.resDict);var n=new f(t,this.resDict);this.sceneMap=n,document.addEventListener("keydown",this.player.onKeyDown),document.addEventListener("keyup",this.player.onKeyUp),new u.w(9e3,200).position.y=2;var a=new u.Gb,o=new u.T(new u.hb(1e4,1e4,200,200),new u.V({specular:1118481,map:a.load("https://threejs.org/examples/models/gltf/LeePerrySmith/Map-COL.jpg"),specularMap:a.load("https://threejs.org/examples/models/gltf/LeePerrySmith/Map-SPEC.jpg"),normalMap:a.load("https://threejs.org/examples/models/gltf/LeePerrySmith/Infinite-Level_02_Tangent_SmoothUV.jpg"),shininess:25})),s=new u.e(200,200,200),r=new u.U({envMap:this.resDict.texCube.val}),c=new u.T(s,r);c.position.set(911.9191571353953,172.85702349744838,509.97206583931273),t.add(c);var h=this.resDict.crater.val.scene;h.position.y=30,h.scale.multiplyScalar(3),t.add(this.resDict.crater.val.scene),this.resDict.texCube.val.encoding=u.Ob,t.background=15716789,o.position.y=0,o.rotation.x=-Math.PI/2,new u.Db(16777215,.25).position.set(45,50,15);var l=new u.a(3355443);l.position.set(5,3,5),this.camera.add(l),this.camera.lookAt(this.player.position.clone()),this.camera.updateProjectionMatrix(),this.camera.position.x=100,this.camera.position.y=50;var d=new m.a(this.camera,this.renderer.domElement);d.enableDamping=!0,d.dampingFactor=.25,d.enableZoom=!0,d.zoomSpeed=2.1,d.enableKeys=!1,d.screenSpacePanning=!1,d.enableRotate=!0,d.dampingFactor=1,d.autoRotateSpeed=1.2,d.enablePan=!1,d.target.copy(this.player.position),d.update(),this.controls=d,this.renderer.setSize(this.width,this.height),this.container.appendChild(this.renderer.domElement),this.stats=new j.a,this.container.appendChild(this.stats.dom),this.start()}},{key:"start",value:function(){this.frameId||(this.frameId=requestAnimationFrame(this.animate))}},{key:"renderScene",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"animate",value:function(){this.frameId=requestAnimationFrame(this.animate),this.controls.update();var e=this.player.position.clone();this.player.update(.01,!0,this.camera.quaternion);var t=this.player.position.clone();t.setY(t.y+5);var i=this.player.position.clone().sub(e);this.controls.target.copy(t),this.camera.position.addVectors(this.camera.position,i);var n=(new u.Lb).subVectors(this.camera.position,t);n.length()>15&&this.camera.position.copy(n.clampLength(0,15).add(t)),this.stats.update(),this.renderScene()}},{key:"stop",value:function(){cancelAnimationFrame(this.frameId)}},{key:"handleWindowResize",value:function(){var e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix()}},{key:"componentWillUnmount",value:function(){this.stop(),this.destroyContext()}},{key:"destroyContext",value:function(){this.container.removeChild(this.renderer.domElement),this.renderer.forceContextLoss(),this.renderer.context=null,this.renderer.domElement=null,this.renderer=null}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{ref:function(t){e.container=t},style:{width:"100%",height:"100%",position:"absolute",overflow:"hidden"}})}}]),t}(n.Component),O=function(e){function t(){return Object(r.a)(this,t),Object(h.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement(x,null))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[16,2,1]]]);
//# sourceMappingURL=main.03d11466.chunk.js.map